"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n/**\n * Middleware for dual-domain architecture\n * \n * Routes requests based on Host header:\n * - revol.app / app.revol.app → App domain (dashboard, auth, marketing)\n * - *.main.tld → Customer website domain (public sites, booking flows)\n */ // Domain configuration\nconst APP_DOMAINS = [\n    \"revol.app\",\n    \"app.revol.app\"\n];\nconst CUSTOMER_DOMAIN_SUFFIX = \".main.tld\"; // Replace with actual domain when known\nfunction middleware(request) {\n    const host = request.headers.get(\"host\") || \"\";\n    const hostname = host.split(\":\")[0]; // Remove port if present\n    // Check if this is a customer website domain (*.main.tld)\n    if (hostname.endsWith(CUSTOMER_DOMAIN_SUFFIX)) {\n        // Extract tenant slug from subdomain\n        const tenantSlug = hostname.replace(CUSTOMER_DOMAIN_SUFFIX, \"\").toLowerCase();\n        // Validate tenant slug (must not be empty and should be alphanumeric with hyphens)\n        if (!tenantSlug || tenantSlug.length === 0 || hostname === `www${CUSTOMER_DOMAIN_SUFFIX}` || hostname === CUSTOMER_DOMAIN_SUFFIX.replace(\".\", \"\")) {\n            // If it's exactly \"main.tld\" or \"www.main.tld\", redirect to app domain\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"https://www.revol.app\", request.url));\n        }\n        // For customer website requests, rewrite to /tenant route\n        // This allows us to use Next.js routing while maintaining subdomain-based access\n        const pathname = request.nextUrl.pathname;\n        // Rewrite to /tenant for all customer domain requests\n        // The tenant page will extract the slug from the hostname\n        const url = request.nextUrl.clone();\n        url.pathname = \"/tenant\";\n        // Add tenant slug to headers for use in route handlers\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(url);\n        response.headers.set(\"x-tenant-slug\", tenantSlug);\n        return response;\n    }\n    // For app domain (revol.app), ensure we're not serving customer content\n    // Block any /public/[slug] routes on app domain (they should only work on *.main.tld)\n    if (APP_DOMAINS.some((domain)=>hostname === domain || hostname.endsWith(`.${domain}`))) {\n        const pathname = request.nextUrl.pathname;\n        // Block public routes on app domain\n        if (pathname.startsWith(\"/public/\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Default: allow the request\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */ \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBRzNDOzs7Ozs7Q0FNQyxHQUVELHVCQUF1QjtBQUN2QixNQUFNQyxjQUFjO0lBQUM7SUFBYTtDQUFnQjtBQUNsRCxNQUFNQyx5QkFBeUIsYUFBYSx3Q0FBd0M7QUFFN0UsU0FBU0MsV0FBV0MsT0FBb0I7SUFDN0MsTUFBTUMsT0FBT0QsUUFBUUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsV0FBVztJQUM1QyxNQUFNQyxXQUFXSCxLQUFLSSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSx5QkFBeUI7SUFFOUQsMERBQTBEO0lBQzFELElBQUlELFNBQVNFLFFBQVEsQ0FBQ1IseUJBQXlCO1FBQzdDLHFDQUFxQztRQUNyQyxNQUFNUyxhQUFhSCxTQUFTSSxPQUFPLENBQUNWLHdCQUF3QixJQUFJVyxXQUFXO1FBRTNFLG1GQUFtRjtRQUNuRixJQUFJLENBQUNGLGNBQWNBLFdBQVdHLE1BQU0sS0FBSyxLQUFLTixhQUFhLENBQUMsR0FBRyxFQUFFTix1QkFBdUIsQ0FBQyxJQUFJTSxhQUFhTix1QkFBdUJVLE9BQU8sQ0FBQyxLQUFLLEtBQUs7WUFDakosdUVBQXVFO1lBQ3ZFLE9BQU9aLHFEQUFZQSxDQUFDZSxRQUFRLENBQUMsSUFBSUMsSUFBSSx5QkFBeUJaLFFBQVFhLEdBQUc7UUFDM0U7UUFFQSwwREFBMEQ7UUFDMUQsaUZBQWlGO1FBQ2pGLE1BQU1DLFdBQVdkLFFBQVFlLE9BQU8sQ0FBQ0QsUUFBUTtRQUV6QyxzREFBc0Q7UUFDdEQsMERBQTBEO1FBQzFELE1BQU1ELE1BQU1iLFFBQVFlLE9BQU8sQ0FBQ0MsS0FBSztRQUNqQ0gsSUFBSUMsUUFBUSxHQUFHO1FBRWYsdURBQXVEO1FBQ3ZELE1BQU1HLFdBQVdyQixxREFBWUEsQ0FBQ3NCLE9BQU8sQ0FBQ0w7UUFDdENJLFNBQVNmLE9BQU8sQ0FBQ2lCLEdBQUcsQ0FBQyxpQkFBaUJaO1FBRXRDLE9BQU9VO0lBQ1Q7SUFFQSx3RUFBd0U7SUFDeEUsc0ZBQXNGO0lBQ3RGLElBQUlwQixZQUFZdUIsSUFBSSxDQUFDQyxDQUFBQSxTQUFVakIsYUFBYWlCLFVBQVVqQixTQUFTRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUVlLE9BQU8sQ0FBQyxJQUFJO1FBQ3RGLE1BQU1QLFdBQVdkLFFBQVFlLE9BQU8sQ0FBQ0QsUUFBUTtRQUV6QyxvQ0FBb0M7UUFDcEMsSUFBSUEsU0FBU1EsVUFBVSxDQUFDLGFBQWE7WUFDbkMsT0FBTzFCLHFEQUFZQSxDQUFDZSxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLWixRQUFRYSxHQUFHO1FBQ3ZEO1FBRUEsT0FBT2pCLHFEQUFZQSxDQUFDMkIsSUFBSTtJQUMxQjtJQUVBLDZCQUE2QjtJQUM3QixPQUFPM0IscURBQVlBLENBQUMyQixJQUFJO0FBQzFCO0FBRU8sTUFBTUMsU0FBUztJQUNwQkMsU0FBUztRQUNQOzs7Ozs7S0FNQyxHQUNEO0tBQ0Q7QUFDSCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9taWRkbGV3YXJlLnRzP2QxOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLyoqXG4gKiBNaWRkbGV3YXJlIGZvciBkdWFsLWRvbWFpbiBhcmNoaXRlY3R1cmVcbiAqIFxuICogUm91dGVzIHJlcXVlc3RzIGJhc2VkIG9uIEhvc3QgaGVhZGVyOlxuICogLSByZXZvbC5hcHAgLyBhcHAucmV2b2wuYXBwIOKGkiBBcHAgZG9tYWluIChkYXNoYm9hcmQsIGF1dGgsIG1hcmtldGluZylcbiAqIC0gKi5tYWluLnRsZCDihpIgQ3VzdG9tZXIgd2Vic2l0ZSBkb21haW4gKHB1YmxpYyBzaXRlcywgYm9va2luZyBmbG93cylcbiAqL1xuXG4vLyBEb21haW4gY29uZmlndXJhdGlvblxuY29uc3QgQVBQX0RPTUFJTlMgPSBbJ3Jldm9sLmFwcCcsICdhcHAucmV2b2wuYXBwJ107XG5jb25zdCBDVVNUT01FUl9ET01BSU5fU1VGRklYID0gJy5tYWluLnRsZCc7IC8vIFJlcGxhY2Ugd2l0aCBhY3R1YWwgZG9tYWluIHdoZW4ga25vd25cblxuZXhwb3J0IGZ1bmN0aW9uIG1pZGRsZXdhcmUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgaG9zdCA9IHJlcXVlc3QuaGVhZGVycy5nZXQoJ2hvc3QnKSB8fCAnJztcbiAgY29uc3QgaG9zdG5hbWUgPSBob3N0LnNwbGl0KCc6JylbMF07IC8vIFJlbW92ZSBwb3J0IGlmIHByZXNlbnRcbiAgXG4gIC8vIENoZWNrIGlmIHRoaXMgaXMgYSBjdXN0b21lciB3ZWJzaXRlIGRvbWFpbiAoKi5tYWluLnRsZClcbiAgaWYgKGhvc3RuYW1lLmVuZHNXaXRoKENVU1RPTUVSX0RPTUFJTl9TVUZGSVgpKSB7XG4gICAgLy8gRXh0cmFjdCB0ZW5hbnQgc2x1ZyBmcm9tIHN1YmRvbWFpblxuICAgIGNvbnN0IHRlbmFudFNsdWcgPSBob3N0bmFtZS5yZXBsYWNlKENVU1RPTUVSX0RPTUFJTl9TVUZGSVgsICcnKS50b0xvd2VyQ2FzZSgpO1xuICAgIFxuICAgIC8vIFZhbGlkYXRlIHRlbmFudCBzbHVnIChtdXN0IG5vdCBiZSBlbXB0eSBhbmQgc2hvdWxkIGJlIGFscGhhbnVtZXJpYyB3aXRoIGh5cGhlbnMpXG4gICAgaWYgKCF0ZW5hbnRTbHVnIHx8IHRlbmFudFNsdWcubGVuZ3RoID09PSAwIHx8IGhvc3RuYW1lID09PSBgd3d3JHtDVVNUT01FUl9ET01BSU5fU1VGRklYfWAgfHwgaG9zdG5hbWUgPT09IENVU1RPTUVSX0RPTUFJTl9TVUZGSVgucmVwbGFjZSgnLicsICcnKSkge1xuICAgICAgLy8gSWYgaXQncyBleGFjdGx5IFwibWFpbi50bGRcIiBvciBcInd3dy5tYWluLnRsZFwiLCByZWRpcmVjdCB0byBhcHAgZG9tYWluXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJ2h0dHBzOi8vd3d3LnJldm9sLmFwcCcsIHJlcXVlc3QudXJsKSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEZvciBjdXN0b21lciB3ZWJzaXRlIHJlcXVlc3RzLCByZXdyaXRlIHRvIC90ZW5hbnQgcm91dGVcbiAgICAvLyBUaGlzIGFsbG93cyB1cyB0byB1c2UgTmV4dC5qcyByb3V0aW5nIHdoaWxlIG1haW50YWluaW5nIHN1YmRvbWFpbi1iYXNlZCBhY2Nlc3NcbiAgICBjb25zdCBwYXRobmFtZSA9IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZTtcbiAgICBcbiAgICAvLyBSZXdyaXRlIHRvIC90ZW5hbnQgZm9yIGFsbCBjdXN0b21lciBkb21haW4gcmVxdWVzdHNcbiAgICAvLyBUaGUgdGVuYW50IHBhZ2Ugd2lsbCBleHRyYWN0IHRoZSBzbHVnIGZyb20gdGhlIGhvc3RuYW1lXG4gICAgY29uc3QgdXJsID0gcmVxdWVzdC5uZXh0VXJsLmNsb25lKCk7XG4gICAgdXJsLnBhdGhuYW1lID0gJy90ZW5hbnQnO1xuICAgIFxuICAgIC8vIEFkZCB0ZW5hbnQgc2x1ZyB0byBoZWFkZXJzIGZvciB1c2UgaW4gcm91dGUgaGFuZGxlcnNcbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ3gtdGVuYW50LXNsdWcnLCB0ZW5hbnRTbHVnKTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbiAgXG4gIC8vIEZvciBhcHAgZG9tYWluIChyZXZvbC5hcHApLCBlbnN1cmUgd2UncmUgbm90IHNlcnZpbmcgY3VzdG9tZXIgY29udGVudFxuICAvLyBCbG9jayBhbnkgL3B1YmxpYy9bc2x1Z10gcm91dGVzIG9uIGFwcCBkb21haW4gKHRoZXkgc2hvdWxkIG9ubHkgd29yayBvbiAqLm1haW4udGxkKVxuICBpZiAoQVBQX0RPTUFJTlMuc29tZShkb21haW4gPT4gaG9zdG5hbWUgPT09IGRvbWFpbiB8fCBob3N0bmFtZS5lbmRzV2l0aChgLiR7ZG9tYWlufWApKSkge1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lO1xuICAgIFxuICAgIC8vIEJsb2NrIHB1YmxpYyByb3V0ZXMgb24gYXBwIGRvbWFpblxuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvcHVibGljLycpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy8nLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuICBcbiAgLy8gRGVmYXVsdDogYWxsb3cgdGhlIHJlcXVlc3RcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAvKlxuICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbiAgICAgKiAtIGFwaSAoQVBJIHJvdXRlcylcbiAgICAgKiAtIF9uZXh0L3N0YXRpYyAoc3RhdGljIGZpbGVzKVxuICAgICAqIC0gX25leHQvaW1hZ2UgKGltYWdlIG9wdGltaXphdGlvbiBmaWxlcylcbiAgICAgKiAtIGZhdmljb24uaWNvIChmYXZpY29uIGZpbGUpXG4gICAgICovXG4gICAgJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKiknLFxuICBdLFxufTtcblxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkFQUF9ET01BSU5TIiwiQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwiaG9zdCIsImhlYWRlcnMiLCJnZXQiLCJob3N0bmFtZSIsInNwbGl0IiwiZW5kc1dpdGgiLCJ0ZW5hbnRTbHVnIiwicmVwbGFjZSIsInRvTG93ZXJDYXNlIiwibGVuZ3RoIiwicmVkaXJlY3QiLCJVUkwiLCJ1cmwiLCJwYXRobmFtZSIsIm5leHRVcmwiLCJjbG9uZSIsInJlc3BvbnNlIiwicmV3cml0ZSIsInNldCIsInNvbWUiLCJkb21haW4iLCJzdGFydHNXaXRoIiwibmV4dCIsImNvbmZpZyIsIm1hdGNoZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});