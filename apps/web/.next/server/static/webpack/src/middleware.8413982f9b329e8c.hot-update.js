"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n/**\n * Middleware for dual-domain architecture\n * \n * Routes requests based on Host header:\n * - revol.app / app.revol.app → App domain (dashboard, auth, marketing)\n * - *.main.tld → Customer website domain (public sites, booking flows)\n */ // Domain configuration\nconst APP_DOMAINS = [\n    \"revol.app\",\n    \"www.revol.app\",\n    \"app.revol.app\"\n];\nconst CUSTOMER_DOMAIN_SUFFIX = \".main.tld\"; // Replace with actual domain when known\nfunction middleware(request) {\n    const host = request.headers.get(\"host\") || \"\";\n    const hostname = host.split(\":\")[0]; // Remove port if present\n    // Check if this is a customer website domain (*.main.tld)\n    if (hostname.endsWith(CUSTOMER_DOMAIN_SUFFIX)) {\n        // Extract tenant slug from subdomain\n        const tenantSlug = hostname.replace(CUSTOMER_DOMAIN_SUFFIX, \"\").toLowerCase();\n        // Validate tenant slug (must not be empty and should be alphanumeric with hyphens)\n        if (!tenantSlug || tenantSlug.length === 0 || hostname === `www${CUSTOMER_DOMAIN_SUFFIX}` || hostname === CUSTOMER_DOMAIN_SUFFIX.replace(\".\", \"\")) {\n            // If it's exactly \"main.tld\" or \"www.main.tld\", redirect to app domain\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"https://www.revol.app\", request.url));\n        }\n        // For customer website requests, rewrite to /tenant route\n        // This allows us to use Next.js routing while maintaining subdomain-based access\n        const pathname = request.nextUrl.pathname;\n        // Rewrite to /tenant for all customer domain requests\n        // The tenant page will extract the slug from the hostname\n        const url = request.nextUrl.clone();\n        url.pathname = \"/tenant\";\n        // Add tenant slug to headers for use in route handlers\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(url);\n        response.headers.set(\"x-tenant-slug\", tenantSlug);\n        return response;\n    }\n    // For app domain (revol.app), ensure we're not serving customer content\n    // Block any /public/[slug] routes on app domain (they should only work on *.main.tld)\n    if (APP_DOMAINS.some((domain)=>hostname === domain || hostname.endsWith(`.${domain}`))) {\n        const pathname = request.nextUrl.pathname;\n        // Block public routes on app domain\n        if (pathname.startsWith(\"/public/\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Default: allow the request\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */ \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBRzNDOzs7Ozs7Q0FNQyxHQUVELHVCQUF1QjtBQUN2QixNQUFNQyxjQUFjO0lBQUM7SUFBYTtJQUFpQjtDQUFnQjtBQUNuRSxNQUFNQyx5QkFBeUIsYUFBYSx3Q0FBd0M7QUFFN0UsU0FBU0MsV0FBV0MsT0FBb0I7SUFDN0MsTUFBTUMsT0FBT0QsUUFBUUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsV0FBVztJQUM1QyxNQUFNQyxXQUFXSCxLQUFLSSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSx5QkFBeUI7SUFFOUQsMERBQTBEO0lBQzFELElBQUlELFNBQVNFLFFBQVEsQ0FBQ1IseUJBQXlCO1FBQzdDLHFDQUFxQztRQUNyQyxNQUFNUyxhQUFhSCxTQUFTSSxPQUFPLENBQUNWLHdCQUF3QixJQUFJVyxXQUFXO1FBRTNFLG1GQUFtRjtRQUNuRixJQUFJLENBQUNGLGNBQWNBLFdBQVdHLE1BQU0sS0FBSyxLQUFLTixhQUFhLENBQUMsR0FBRyxFQUFFTix1QkFBdUIsQ0FBQyxJQUFJTSxhQUFhTix1QkFBdUJVLE9BQU8sQ0FBQyxLQUFLLEtBQUs7WUFDakosdUVBQXVFO1lBQ3ZFLE9BQU9aLHFEQUFZQSxDQUFDZSxRQUFRLENBQUMsSUFBSUMsSUFBSSx5QkFBeUJaLFFBQVFhLEdBQUc7UUFDM0U7UUFFQSwwREFBMEQ7UUFDMUQsaUZBQWlGO1FBQ2pGLE1BQU1DLFdBQVdkLFFBQVFlLE9BQU8sQ0FBQ0QsUUFBUTtRQUV6QyxzREFBc0Q7UUFDdEQsMERBQTBEO1FBQzFELE1BQU1ELE1BQU1iLFFBQVFlLE9BQU8sQ0FBQ0MsS0FBSztRQUNqQ0gsSUFBSUMsUUFBUSxHQUFHO1FBRWYsdURBQXVEO1FBQ3ZELE1BQU1HLFdBQVdyQixxREFBWUEsQ0FBQ3NCLE9BQU8sQ0FBQ0w7UUFDdENJLFNBQVNmLE9BQU8sQ0FBQ2lCLEdBQUcsQ0FBQyxpQkFBaUJaO1FBRXRDLE9BQU9VO0lBQ1Q7SUFFQSx3RUFBd0U7SUFDeEUsc0ZBQXNGO0lBQ3RGLElBQUlwQixZQUFZdUIsSUFBSSxDQUFDQyxDQUFBQSxTQUFVakIsYUFBYWlCLFVBQVVqQixTQUFTRSxRQUFRLENBQUMsQ0FBQyxDQUFDLEVBQUVlLE9BQU8sQ0FBQyxJQUFJO1FBQ3RGLE1BQU1QLFdBQVdkLFFBQVFlLE9BQU8sQ0FBQ0QsUUFBUTtRQUV6QyxvQ0FBb0M7UUFDcEMsSUFBSUEsU0FBU1EsVUFBVSxDQUFDLGFBQWE7WUFDbkMsT0FBTzFCLHFEQUFZQSxDQUFDZSxRQUFRLENBQUMsSUFBSUMsSUFBSSxLQUFLWixRQUFRYSxHQUFHO1FBQ3ZEO1FBRUEsT0FBT2pCLHFEQUFZQSxDQUFDMkIsSUFBSTtJQUMxQjtJQUVBLDZCQUE2QjtJQUM3QixPQUFPM0IscURBQVlBLENBQUMyQixJQUFJO0FBQzFCO0FBRU8sTUFBTUMsU0FBUztJQUNwQkMsU0FBUztRQUNQOzs7Ozs7S0FNQyxHQUNEO0tBQ0Q7QUFDSCxFQUFFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vX05fRS8uL3NyYy9taWRkbGV3YXJlLnRzP2QxOTkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHR5cGUgeyBOZXh0UmVxdWVzdCB9IGZyb20gJ25leHQvc2VydmVyJztcblxuLyoqXG4gKiBNaWRkbGV3YXJlIGZvciBkdWFsLWRvbWFpbiBhcmNoaXRlY3R1cmVcbiAqIFxuICogUm91dGVzIHJlcXVlc3RzIGJhc2VkIG9uIEhvc3QgaGVhZGVyOlxuICogLSByZXZvbC5hcHAgLyBhcHAucmV2b2wuYXBwIOKGkiBBcHAgZG9tYWluIChkYXNoYm9hcmQsIGF1dGgsIG1hcmtldGluZylcbiAqIC0gKi5tYWluLnRsZCDihpIgQ3VzdG9tZXIgd2Vic2l0ZSBkb21haW4gKHB1YmxpYyBzaXRlcywgYm9va2luZyBmbG93cylcbiAqL1xuXG4vLyBEb21haW4gY29uZmlndXJhdGlvblxuY29uc3QgQVBQX0RPTUFJTlMgPSBbJ3Jldm9sLmFwcCcsICd3d3cucmV2b2wuYXBwJywgJ2FwcC5yZXZvbC5hcHAnXTtcbmNvbnN0IENVU1RPTUVSX0RPTUFJTl9TVUZGSVggPSAnLm1haW4udGxkJzsgLy8gUmVwbGFjZSB3aXRoIGFjdHVhbCBkb21haW4gd2hlbiBrbm93blxuXG5leHBvcnQgZnVuY3Rpb24gbWlkZGxld2FyZShyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCBob3N0ID0gcmVxdWVzdC5oZWFkZXJzLmdldCgnaG9zdCcpIHx8ICcnO1xuICBjb25zdCBob3N0bmFtZSA9IGhvc3Quc3BsaXQoJzonKVswXTsgLy8gUmVtb3ZlIHBvcnQgaWYgcHJlc2VudFxuICBcbiAgLy8gQ2hlY2sgaWYgdGhpcyBpcyBhIGN1c3RvbWVyIHdlYnNpdGUgZG9tYWluICgqLm1haW4udGxkKVxuICBpZiAoaG9zdG5hbWUuZW5kc1dpdGgoQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCkpIHtcbiAgICAvLyBFeHRyYWN0IHRlbmFudCBzbHVnIGZyb20gc3ViZG9tYWluXG4gICAgY29uc3QgdGVuYW50U2x1ZyA9IGhvc3RuYW1lLnJlcGxhY2UoQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCwgJycpLnRvTG93ZXJDYXNlKCk7XG4gICAgXG4gICAgLy8gVmFsaWRhdGUgdGVuYW50IHNsdWcgKG11c3Qgbm90IGJlIGVtcHR5IGFuZCBzaG91bGQgYmUgYWxwaGFudW1lcmljIHdpdGggaHlwaGVucylcbiAgICBpZiAoIXRlbmFudFNsdWcgfHwgdGVuYW50U2x1Zy5sZW5ndGggPT09IDAgfHwgaG9zdG5hbWUgPT09IGB3d3cke0NVU1RPTUVSX0RPTUFJTl9TVUZGSVh9YCB8fCBob3N0bmFtZSA9PT0gQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWC5yZXBsYWNlKCcuJywgJycpKSB7XG4gICAgICAvLyBJZiBpdCdzIGV4YWN0bHkgXCJtYWluLnRsZFwiIG9yIFwid3d3Lm1haW4udGxkXCIsIHJlZGlyZWN0IHRvIGFwcCBkb21haW5cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnaHR0cHM6Ly93d3cucmV2b2wuYXBwJywgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgXG4gICAgLy8gRm9yIGN1c3RvbWVyIHdlYnNpdGUgcmVxdWVzdHMsIHJld3JpdGUgdG8gL3RlbmFudCByb3V0ZVxuICAgIC8vIFRoaXMgYWxsb3dzIHVzIHRvIHVzZSBOZXh0LmpzIHJvdXRpbmcgd2hpbGUgbWFpbnRhaW5pbmcgc3ViZG9tYWluLWJhc2VkIGFjY2Vzc1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lO1xuICAgIFxuICAgIC8vIFJld3JpdGUgdG8gL3RlbmFudCBmb3IgYWxsIGN1c3RvbWVyIGRvbWFpbiByZXF1ZXN0c1xuICAgIC8vIFRoZSB0ZW5hbnQgcGFnZSB3aWxsIGV4dHJhY3QgdGhlIHNsdWcgZnJvbSB0aGUgaG9zdG5hbWVcbiAgICBjb25zdCB1cmwgPSByZXF1ZXN0Lm5leHRVcmwuY2xvbmUoKTtcbiAgICB1cmwucGF0aG5hbWUgPSAnL3RlbmFudCc7XG4gICAgXG4gICAgLy8gQWRkIHRlbmFudCBzbHVnIHRvIGhlYWRlcnMgZm9yIHVzZSBpbiByb3V0ZSBoYW5kbGVyc1xuICAgIGNvbnN0IHJlc3BvbnNlID0gTmV4dFJlc3BvbnNlLnJld3JpdGUodXJsKTtcbiAgICByZXNwb25zZS5oZWFkZXJzLnNldCgneC10ZW5hbnQtc2x1ZycsIHRlbmFudFNsdWcpO1xuICAgIFxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfVxuICBcbiAgLy8gRm9yIGFwcCBkb21haW4gKHJldm9sLmFwcCksIGVuc3VyZSB3ZSdyZSBub3Qgc2VydmluZyBjdXN0b21lciBjb250ZW50XG4gIC8vIEJsb2NrIGFueSAvcHVibGljL1tzbHVnXSByb3V0ZXMgb24gYXBwIGRvbWFpbiAodGhleSBzaG91bGQgb25seSB3b3JrIG9uICoubWFpbi50bGQpXG4gIGlmIChBUFBfRE9NQUlOUy5zb21lKGRvbWFpbiA9PiBob3N0bmFtZSA9PT0gZG9tYWluIHx8IGhvc3RuYW1lLmVuZHNXaXRoKGAuJHtkb21haW59YCkpKSB7XG4gICAgY29uc3QgcGF0aG5hbWUgPSByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWU7XG4gICAgXG4gICAgLy8gQmxvY2sgcHVibGljIHJvdXRlcyBvbiBhcHAgZG9tYWluXG4gICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9wdWJsaWMvJykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QobmV3IFVSTCgnLycsIHJlcXVlc3QudXJsKSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xuICB9XG4gIFxuICAvLyBEZWZhdWx0OiBhbGxvdyB0aGUgcmVxdWVzdFxuICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgbWF0Y2hlcjogW1xuICAgIC8qXG4gICAgICogTWF0Y2ggYWxsIHJlcXVlc3QgcGF0aHMgZXhjZXB0IGZvciB0aGUgb25lcyBzdGFydGluZyB3aXRoOlxuICAgICAqIC0gYXBpIChBUEkgcm91dGVzKVxuICAgICAqIC0gX25leHQvc3RhdGljIChzdGF0aWMgZmlsZXMpXG4gICAgICogLSBfbmV4dC9pbWFnZSAoaW1hZ2Ugb3B0aW1pemF0aW9uIGZpbGVzKVxuICAgICAqIC0gZmF2aWNvbi5pY28gKGZhdmljb24gZmlsZSlcbiAgICAgKi9cbiAgICAnLygoPyFhcGl8X25leHQvc3RhdGljfF9uZXh0L2ltYWdlfGZhdmljb24uaWNvKS4qKScsXG4gIF0sXG59O1xuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiQVBQX0RPTUFJTlMiLCJDVVNUT01FUl9ET01BSU5fU1VGRklYIiwibWlkZGxld2FyZSIsInJlcXVlc3QiLCJob3N0IiwiaGVhZGVycyIsImdldCIsImhvc3RuYW1lIiwic3BsaXQiLCJlbmRzV2l0aCIsInRlbmFudFNsdWciLCJyZXBsYWNlIiwidG9Mb3dlckNhc2UiLCJsZW5ndGgiLCJyZWRpcmVjdCIsIlVSTCIsInVybCIsInBhdGhuYW1lIiwibmV4dFVybCIsImNsb25lIiwicmVzcG9uc2UiLCJyZXdyaXRlIiwic2V0Iiwic29tZSIsImRvbWFpbiIsInN0YXJ0c1dpdGgiLCJuZXh0IiwiY29uZmlnIiwibWF0Y2hlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});