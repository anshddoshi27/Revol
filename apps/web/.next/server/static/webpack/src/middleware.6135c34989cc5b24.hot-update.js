"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n/**\n * Middleware for dual-domain architecture\n * \n * Routes requests based on Host header:\n * - revol.app / www.revol.app / app.revol.app → App domain (dashboard, auth, marketing)\n * - main.tld / www.main.tld → Redirect to www.revol.app\n * - {businessname}.main.tld → Customer booking sites (public sites, booking flows)\n */ // Domain configuration\nconst APP_DOMAINS = [\n    \"revol.app\",\n    \"www.revol.app\",\n    \"app.revol.app\"\n];\nconst CUSTOMER_DOMAIN_SUFFIX = \".main.tld\"; // Replace with actual domain when known\nfunction middleware(request) {\n    const host = request.headers.get(\"host\") || \"\";\n    const hostname = host.split(\":\")[0]; // Remove port if present\n    // Check if this is a customer website domain (*.main.tld)\n    if (hostname.endsWith(CUSTOMER_DOMAIN_SUFFIX)) {\n        // Extract tenant slug from subdomain\n        const tenantSlug = hostname.replace(CUSTOMER_DOMAIN_SUFFIX, \"\").toLowerCase();\n        // Validate tenant slug (must not be empty and should be alphanumeric with hyphens)\n        if (!tenantSlug || tenantSlug.length === 0 || hostname === `www${CUSTOMER_DOMAIN_SUFFIX}` || hostname === CUSTOMER_DOMAIN_SUFFIX.replace(\".\", \"\")) {\n            // If it's exactly \"main.tld\" or \"www.main.tld\", redirect to app domain\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"https://www.revol.app\", request.url));\n        }\n        // For customer website requests, rewrite to /tenant route\n        // This allows us to use Next.js routing while maintaining subdomain-based access\n        const pathname = request.nextUrl.pathname;\n        // Rewrite to /tenant for all customer domain requests\n        // The tenant page will extract the slug from the hostname\n        const url = request.nextUrl.clone();\n        url.pathname = \"/tenant\";\n        // Add tenant slug to headers for use in route handlers\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(url);\n        response.headers.set(\"x-tenant-slug\", tenantSlug);\n        return response;\n    }\n    // For app domain (revol.app), ensure we're not serving customer content\n    // Block any /public/[slug] routes on app domain (they should only work on *.main.tld)\n    if (APP_DOMAINS.some((domain)=>hostname === domain || hostname.endsWith(`.${domain}`))) {\n        const pathname = request.nextUrl.pathname;\n        // Block public routes on app domain\n        if (pathname.startsWith(\"/public/\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Default: allow the request\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */ \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBRzNDOzs7Ozs7O0NBT0MsR0FFRCx1QkFBdUI7QUFDdkIsTUFBTUMsY0FBYztJQUFDO0lBQWE7SUFBaUI7Q0FBZ0I7QUFDbkUsTUFBTUMseUJBQXlCLGFBQWEsd0NBQXdDO0FBRTdFLFNBQVNDLFdBQVdDLE9BQW9CO0lBQzdDLE1BQU1DLE9BQU9ELFFBQVFFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFdBQVc7SUFDNUMsTUFBTUMsV0FBV0gsS0FBS0ksS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFFLEVBQUUseUJBQXlCO0lBRTlELDBEQUEwRDtJQUMxRCxJQUFJRCxTQUFTRSxRQUFRLENBQUNSLHlCQUF5QjtRQUM3QyxxQ0FBcUM7UUFDckMsTUFBTVMsYUFBYUgsU0FBU0ksT0FBTyxDQUFDVix3QkFBd0IsSUFBSVcsV0FBVztRQUUzRSxtRkFBbUY7UUFDbkYsSUFBSSxDQUFDRixjQUFjQSxXQUFXRyxNQUFNLEtBQUssS0FBS04sYUFBYSxDQUFDLEdBQUcsRUFBRU4sdUJBQXVCLENBQUMsSUFBSU0sYUFBYU4sdUJBQXVCVSxPQUFPLENBQUMsS0FBSyxLQUFLO1lBQ2pKLHVFQUF1RTtZQUN2RSxPQUFPWixxREFBWUEsQ0FBQ2UsUUFBUSxDQUFDLElBQUlDLElBQUkseUJBQXlCWixRQUFRYSxHQUFHO1FBQzNFO1FBRUEsMERBQTBEO1FBQzFELGlGQUFpRjtRQUNqRixNQUFNQyxXQUFXZCxRQUFRZSxPQUFPLENBQUNELFFBQVE7UUFFekMsc0RBQXNEO1FBQ3RELDBEQUEwRDtRQUMxRCxNQUFNRCxNQUFNYixRQUFRZSxPQUFPLENBQUNDLEtBQUs7UUFDakNILElBQUlDLFFBQVEsR0FBRztRQUVmLHVEQUF1RDtRQUN2RCxNQUFNRyxXQUFXckIscURBQVlBLENBQUNzQixPQUFPLENBQUNMO1FBQ3RDSSxTQUFTZixPQUFPLENBQUNpQixHQUFHLENBQUMsaUJBQWlCWjtRQUV0QyxPQUFPVTtJQUNUO0lBRUEsd0VBQXdFO0lBQ3hFLHNGQUFzRjtJQUN0RixJQUFJcEIsWUFBWXVCLElBQUksQ0FBQ0MsQ0FBQUEsU0FBVWpCLGFBQWFpQixVQUFVakIsU0FBU0UsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFZSxPQUFPLENBQUMsSUFBSTtRQUN0RixNQUFNUCxXQUFXZCxRQUFRZSxPQUFPLENBQUNELFFBQVE7UUFFekMsb0NBQW9DO1FBQ3BDLElBQUlBLFNBQVNRLFVBQVUsQ0FBQyxhQUFhO1lBQ25DLE9BQU8xQixxREFBWUEsQ0FBQ2UsUUFBUSxDQUFDLElBQUlDLElBQUksS0FBS1osUUFBUWEsR0FBRztRQUN2RDtRQUVBLE9BQU9qQixxREFBWUEsQ0FBQzJCLElBQUk7SUFDMUI7SUFFQSw2QkFBNkI7SUFDN0IsT0FBTzNCLHFEQUFZQSxDQUFDMkIsSUFBSTtBQUMxQjtBQUVPLE1BQU1DLFNBQVM7SUFDcEJDLFNBQVM7UUFDUDs7Ozs7O0tBTUMsR0FDRDtLQUNEO0FBQ0gsRUFBRSIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvbWlkZGxld2FyZS50cz9kMTk5Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB0eXBlIHsgTmV4dFJlcXVlc3QgfSBmcm9tICduZXh0L3NlcnZlcic7XG5cbi8qKlxuICogTWlkZGxld2FyZSBmb3IgZHVhbC1kb21haW4gYXJjaGl0ZWN0dXJlXG4gKiBcbiAqIFJvdXRlcyByZXF1ZXN0cyBiYXNlZCBvbiBIb3N0IGhlYWRlcjpcbiAqIC0gcmV2b2wuYXBwIC8gd3d3LnJldm9sLmFwcCAvIGFwcC5yZXZvbC5hcHAg4oaSIEFwcCBkb21haW4gKGRhc2hib2FyZCwgYXV0aCwgbWFya2V0aW5nKVxuICogLSBtYWluLnRsZCAvIHd3dy5tYWluLnRsZCDihpIgUmVkaXJlY3QgdG8gd3d3LnJldm9sLmFwcFxuICogLSB7YnVzaW5lc3NuYW1lfS5tYWluLnRsZCDihpIgQ3VzdG9tZXIgYm9va2luZyBzaXRlcyAocHVibGljIHNpdGVzLCBib29raW5nIGZsb3dzKVxuICovXG5cbi8vIERvbWFpbiBjb25maWd1cmF0aW9uXG5jb25zdCBBUFBfRE9NQUlOUyA9IFsncmV2b2wuYXBwJywgJ3d3dy5yZXZvbC5hcHAnLCAnYXBwLnJldm9sLmFwcCddO1xuY29uc3QgQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCA9ICcubWFpbi50bGQnOyAvLyBSZXBsYWNlIHdpdGggYWN0dWFsIGRvbWFpbiB3aGVuIGtub3duXG5cbmV4cG9ydCBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IGhvc3QgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdob3N0JykgfHwgJyc7XG4gIGNvbnN0IGhvc3RuYW1lID0gaG9zdC5zcGxpdCgnOicpWzBdOyAvLyBSZW1vdmUgcG9ydCBpZiBwcmVzZW50XG4gIFxuICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgY3VzdG9tZXIgd2Vic2l0ZSBkb21haW4gKCoubWFpbi50bGQpXG4gIGlmIChob3N0bmFtZS5lbmRzV2l0aChDVVNUT01FUl9ET01BSU5fU1VGRklYKSkge1xuICAgIC8vIEV4dHJhY3QgdGVuYW50IHNsdWcgZnJvbSBzdWJkb21haW5cbiAgICBjb25zdCB0ZW5hbnRTbHVnID0gaG9zdG5hbWUucmVwbGFjZShDVVNUT01FUl9ET01BSU5fU1VGRklYLCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICAvLyBWYWxpZGF0ZSB0ZW5hbnQgc2x1ZyAobXVzdCBub3QgYmUgZW1wdHkgYW5kIHNob3VsZCBiZSBhbHBoYW51bWVyaWMgd2l0aCBoeXBoZW5zKVxuICAgIGlmICghdGVuYW50U2x1ZyB8fCB0ZW5hbnRTbHVnLmxlbmd0aCA9PT0gMCB8fCBob3N0bmFtZSA9PT0gYHd3dyR7Q1VTVE9NRVJfRE9NQUlOX1NVRkZJWH1gIHx8IGhvc3RuYW1lID09PSBDVVNUT01FUl9ET01BSU5fU1VGRklYLnJlcGxhY2UoJy4nLCAnJykpIHtcbiAgICAgIC8vIElmIGl0J3MgZXhhY3RseSBcIm1haW4udGxkXCIgb3IgXCJ3d3cubWFpbi50bGRcIiwgcmVkaXJlY3QgdG8gYXBwIGRvbWFpblxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCdodHRwczovL3d3dy5yZXZvbC5hcHAnLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICBcbiAgICAvLyBGb3IgY3VzdG9tZXIgd2Vic2l0ZSByZXF1ZXN0cywgcmV3cml0ZSB0byAvdGVuYW50IHJvdXRlXG4gICAgLy8gVGhpcyBhbGxvd3MgdXMgdG8gdXNlIE5leHQuanMgcm91dGluZyB3aGlsZSBtYWludGFpbmluZyBzdWJkb21haW4tYmFzZWQgYWNjZXNzXG4gICAgY29uc3QgcGF0aG5hbWUgPSByZXF1ZXN0Lm5leHRVcmwucGF0aG5hbWU7XG4gICAgXG4gICAgLy8gUmV3cml0ZSB0byAvdGVuYW50IGZvciBhbGwgY3VzdG9tZXIgZG9tYWluIHJlcXVlc3RzXG4gICAgLy8gVGhlIHRlbmFudCBwYWdlIHdpbGwgZXh0cmFjdCB0aGUgc2x1ZyBmcm9tIHRoZSBob3N0bmFtZVxuICAgIGNvbnN0IHVybCA9IHJlcXVlc3QubmV4dFVybC5jbG9uZSgpO1xuICAgIHVybC5wYXRobmFtZSA9ICcvdGVuYW50JztcbiAgICBcbiAgICAvLyBBZGQgdGVuYW50IHNsdWcgdG8gaGVhZGVycyBmb3IgdXNlIGluIHJvdXRlIGhhbmRsZXJzXG4gICAgY29uc3QgcmVzcG9uc2UgPSBOZXh0UmVzcG9uc2UucmV3cml0ZSh1cmwpO1xuICAgIHJlc3BvbnNlLmhlYWRlcnMuc2V0KCd4LXRlbmFudC1zbHVnJywgdGVuYW50U2x1Zyk7XG4gICAgXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9XG4gIFxuICAvLyBGb3IgYXBwIGRvbWFpbiAocmV2b2wuYXBwKSwgZW5zdXJlIHdlJ3JlIG5vdCBzZXJ2aW5nIGN1c3RvbWVyIGNvbnRlbnRcbiAgLy8gQmxvY2sgYW55IC9wdWJsaWMvW3NsdWddIHJvdXRlcyBvbiBhcHAgZG9tYWluICh0aGV5IHNob3VsZCBvbmx5IHdvcmsgb24gKi5tYWluLnRsZClcbiAgaWYgKEFQUF9ET01BSU5TLnNvbWUoZG9tYWluID0+IGhvc3RuYW1lID09PSBkb21haW4gfHwgaG9zdG5hbWUuZW5kc1dpdGgoYC4ke2RvbWFpbn1gKSkpIHtcbiAgICBjb25zdCBwYXRobmFtZSA9IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZTtcbiAgICBcbiAgICAvLyBCbG9jayBwdWJsaWMgcm91dGVzIG9uIGFwcCBkb21haW5cbiAgICBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL3B1YmxpYy8nKSkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdChuZXcgVVJMKCcvJywgcmVxdWVzdC51cmwpKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG4gIH1cbiAgXG4gIC8vIERlZmF1bHQ6IGFsbG93IHRoZSByZXF1ZXN0XG4gIHJldHVybiBOZXh0UmVzcG9uc2UubmV4dCgpO1xufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBtYXRjaGVyOiBbXG4gICAgLypcbiAgICAgKiBNYXRjaCBhbGwgcmVxdWVzdCBwYXRocyBleGNlcHQgZm9yIHRoZSBvbmVzIHN0YXJ0aW5nIHdpdGg6XG4gICAgICogLSBhcGkgKEFQSSByb3V0ZXMpXG4gICAgICogLSBfbmV4dC9zdGF0aWMgKHN0YXRpYyBmaWxlcylcbiAgICAgKiAtIF9uZXh0L2ltYWdlIChpbWFnZSBvcHRpbWl6YXRpb24gZmlsZXMpXG4gICAgICogLSBmYXZpY29uLmljbyAoZmF2aWNvbiBmaWxlKVxuICAgICAqL1xuICAgICcvKCg/IWFwaXxfbmV4dC9zdGF0aWN8X25leHQvaW1hZ2V8ZmF2aWNvbi5pY28pLiopJyxcbiAgXSxcbn07XG5cbiJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJBUFBfRE9NQUlOUyIsIkNVU1RPTUVSX0RPTUFJTl9TVUZGSVgiLCJtaWRkbGV3YXJlIiwicmVxdWVzdCIsImhvc3QiLCJoZWFkZXJzIiwiZ2V0IiwiaG9zdG5hbWUiLCJzcGxpdCIsImVuZHNXaXRoIiwidGVuYW50U2x1ZyIsInJlcGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImxlbmd0aCIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwicGF0aG5hbWUiLCJuZXh0VXJsIiwiY2xvbmUiLCJyZXNwb25zZSIsInJld3JpdGUiLCJzZXQiLCJzb21lIiwiZG9tYWluIiwic3RhcnRzV2l0aCIsIm5leHQiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});