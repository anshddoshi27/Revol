"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("src/middleware",{

/***/ "(middleware)/./src/middleware.ts":
/*!***************************!*\
  !*** ./src/middleware.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n\n/**\n * Middleware for dual-domain architecture\n * \n * Routes requests based on Host header:\n * - revol.app / app.revol.app → App domain (dashboard, auth, marketing)\n * - *.main.tld → Customer website domain (public sites, booking flows)\n */ // Domain configuration\nconst APP_DOMAINS = [\n    \"revol.app\",\n    \"www.revol.app\",\n    \"app.revol.app\"\n];\nconst CUSTOMER_DOMAIN_SUFFIX = \".main.tld\"; // Replace with actual domain when known\nfunction middleware(request) {\n    const host = request.headers.get(\"host\") || \"\";\n    const hostname = host.split(\":\")[0]; // Remove port if present\n    // Check if this is a customer website domain (*.main.tld)\n    if (hostname.endsWith(CUSTOMER_DOMAIN_SUFFIX)) {\n        // Extract tenant slug from subdomain\n        const tenantSlug = hostname.replace(CUSTOMER_DOMAIN_SUFFIX, \"\").toLowerCase();\n        // Validate tenant slug (must not be empty and should be alphanumeric with hyphens)\n        // Handle root domain and www subdomain - redirect to app domain\n        const rootDomain = CUSTOMER_DOMAIN_SUFFIX.replace(\".\", \"\"); // \"main.tld\"\n        const wwwDomain = `www${CUSTOMER_DOMAIN_SUFFIX}`; // \"www.main.tld\"\n        if (!tenantSlug || tenantSlug.length === 0 || hostname === wwwDomain || hostname === rootDomain) {\n            // If it's exactly \"main.tld\" or \"www.main.tld\", redirect to app domain\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"https://www.revol.app\", request.url));\n        }\n        // For customer website requests, rewrite to /tenant route\n        // This allows us to use Next.js routing while maintaining subdomain-based access\n        const pathname = request.nextUrl.pathname;\n        // Rewrite to /tenant for all customer domain requests\n        // The tenant page will extract the slug from the hostname\n        const url = request.nextUrl.clone();\n        url.pathname = \"/tenant\";\n        // Add tenant slug to headers for use in route handlers\n        const response = next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.rewrite(url);\n        response.headers.set(\"x-tenant-slug\", tenantSlug);\n        return response;\n    }\n    // For app domain (revol.app), ensure we're not serving customer content\n    // Block any /public/[slug] routes on app domain (they should only work on *.main.tld)\n    if (APP_DOMAINS.some((domain)=>hostname === domain || hostname.endsWith(`.${domain}`))) {\n        const pathname = request.nextUrl.pathname;\n        // Block public routes on app domain\n        if (pathname.startsWith(\"/public/\")) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(new URL(\"/\", request.url));\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // Default: allow the request\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        /*\n     * Match all request paths except for the ones starting with:\n     * - api (API routes)\n     * - _next/static (static files)\n     * - _next/image (image optimization files)\n     * - favicon.ico (favicon file)\n     */ \"/((?!api|_next/static|_next/image|favicon.ico).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vc3JjL21pZGRsZXdhcmUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQTJDO0FBRzNDOzs7Ozs7Q0FNQyxHQUVELHVCQUF1QjtBQUN2QixNQUFNQyxjQUFjO0lBQUM7SUFBYTtJQUFpQjtDQUFnQjtBQUNuRSxNQUFNQyx5QkFBeUIsYUFBYSx3Q0FBd0M7QUFFN0UsU0FBU0MsV0FBV0MsT0FBb0I7SUFDN0MsTUFBTUMsT0FBT0QsUUFBUUUsT0FBTyxDQUFDQyxHQUFHLENBQUMsV0FBVztJQUM1QyxNQUFNQyxXQUFXSCxLQUFLSSxLQUFLLENBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSx5QkFBeUI7SUFFOUQsMERBQTBEO0lBQzFELElBQUlELFNBQVNFLFFBQVEsQ0FBQ1IseUJBQXlCO1FBQzdDLHFDQUFxQztRQUNyQyxNQUFNUyxhQUFhSCxTQUFTSSxPQUFPLENBQUNWLHdCQUF3QixJQUFJVyxXQUFXO1FBRTNFLG1GQUFtRjtRQUNuRixnRUFBZ0U7UUFDaEUsTUFBTUMsYUFBYVosdUJBQXVCVSxPQUFPLENBQUMsS0FBSyxLQUFLLGFBQWE7UUFDekUsTUFBTUcsWUFBWSxDQUFDLEdBQUcsRUFBRWIsdUJBQXVCLENBQUMsRUFBRSxpQkFBaUI7UUFFbkUsSUFBSSxDQUFDUyxjQUFjQSxXQUFXSyxNQUFNLEtBQUssS0FBS1IsYUFBYU8sYUFBYVAsYUFBYU0sWUFBWTtZQUMvRix1RUFBdUU7WUFDdkUsT0FBT2QscURBQVlBLENBQUNpQixRQUFRLENBQUMsSUFBSUMsSUFBSSx5QkFBeUJkLFFBQVFlLEdBQUc7UUFDM0U7UUFFQSwwREFBMEQ7UUFDMUQsaUZBQWlGO1FBQ2pGLE1BQU1DLFdBQVdoQixRQUFRaUIsT0FBTyxDQUFDRCxRQUFRO1FBRXpDLHNEQUFzRDtRQUN0RCwwREFBMEQ7UUFDMUQsTUFBTUQsTUFBTWYsUUFBUWlCLE9BQU8sQ0FBQ0MsS0FBSztRQUNqQ0gsSUFBSUMsUUFBUSxHQUFHO1FBRWYsdURBQXVEO1FBQ3ZELE1BQU1HLFdBQVd2QixxREFBWUEsQ0FBQ3dCLE9BQU8sQ0FBQ0w7UUFDdENJLFNBQVNqQixPQUFPLENBQUNtQixHQUFHLENBQUMsaUJBQWlCZDtRQUV0QyxPQUFPWTtJQUNUO0lBRUEsd0VBQXdFO0lBQ3hFLHNGQUFzRjtJQUN0RixJQUFJdEIsWUFBWXlCLElBQUksQ0FBQ0MsQ0FBQUEsU0FBVW5CLGFBQWFtQixVQUFVbkIsU0FBU0UsUUFBUSxDQUFDLENBQUMsQ0FBQyxFQUFFaUIsT0FBTyxDQUFDLElBQUk7UUFDdEYsTUFBTVAsV0FBV2hCLFFBQVFpQixPQUFPLENBQUNELFFBQVE7UUFFekMsb0NBQW9DO1FBQ3BDLElBQUlBLFNBQVNRLFVBQVUsQ0FBQyxhQUFhO1lBQ25DLE9BQU81QixxREFBWUEsQ0FBQ2lCLFFBQVEsQ0FBQyxJQUFJQyxJQUFJLEtBQUtkLFFBQVFlLEdBQUc7UUFDdkQ7UUFFQSxPQUFPbkIscURBQVlBLENBQUM2QixJQUFJO0lBQzFCO0lBRUEsNkJBQTZCO0lBQzdCLE9BQU83QixxREFBWUEsQ0FBQzZCLElBQUk7QUFDMUI7QUFFTyxNQUFNQyxTQUFTO0lBQ3BCQyxTQUFTO1FBQ1A7Ozs7OztLQU1DLEdBQ0Q7S0FDRDtBQUNILEVBQUUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL21pZGRsZXdhcmUudHM/ZDE5OSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgdHlwZSB7IE5leHRSZXF1ZXN0IH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuXG4vKipcbiAqIE1pZGRsZXdhcmUgZm9yIGR1YWwtZG9tYWluIGFyY2hpdGVjdHVyZVxuICogXG4gKiBSb3V0ZXMgcmVxdWVzdHMgYmFzZWQgb24gSG9zdCBoZWFkZXI6XG4gKiAtIHJldm9sLmFwcCAvIGFwcC5yZXZvbC5hcHAg4oaSIEFwcCBkb21haW4gKGRhc2hib2FyZCwgYXV0aCwgbWFya2V0aW5nKVxuICogLSAqLm1haW4udGxkIOKGkiBDdXN0b21lciB3ZWJzaXRlIGRvbWFpbiAocHVibGljIHNpdGVzLCBib29raW5nIGZsb3dzKVxuICovXG5cbi8vIERvbWFpbiBjb25maWd1cmF0aW9uXG5jb25zdCBBUFBfRE9NQUlOUyA9IFsncmV2b2wuYXBwJywgJ3d3dy5yZXZvbC5hcHAnLCAnYXBwLnJldm9sLmFwcCddO1xuY29uc3QgQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCA9ICcubWFpbi50bGQnOyAvLyBSZXBsYWNlIHdpdGggYWN0dWFsIGRvbWFpbiB3aGVuIGtub3duXG5cbmV4cG9ydCBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IGhvc3QgPSByZXF1ZXN0LmhlYWRlcnMuZ2V0KCdob3N0JykgfHwgJyc7XG4gIGNvbnN0IGhvc3RuYW1lID0gaG9zdC5zcGxpdCgnOicpWzBdOyAvLyBSZW1vdmUgcG9ydCBpZiBwcmVzZW50XG4gIFxuICAvLyBDaGVjayBpZiB0aGlzIGlzIGEgY3VzdG9tZXIgd2Vic2l0ZSBkb21haW4gKCoubWFpbi50bGQpXG4gIGlmIChob3N0bmFtZS5lbmRzV2l0aChDVVNUT01FUl9ET01BSU5fU1VGRklYKSkge1xuICAgIC8vIEV4dHJhY3QgdGVuYW50IHNsdWcgZnJvbSBzdWJkb21haW5cbiAgICBjb25zdCB0ZW5hbnRTbHVnID0gaG9zdG5hbWUucmVwbGFjZShDVVNUT01FUl9ET01BSU5fU1VGRklYLCAnJykudG9Mb3dlckNhc2UoKTtcbiAgICBcbiAgICAvLyBWYWxpZGF0ZSB0ZW5hbnQgc2x1ZyAobXVzdCBub3QgYmUgZW1wdHkgYW5kIHNob3VsZCBiZSBhbHBoYW51bWVyaWMgd2l0aCBoeXBoZW5zKVxuICAgIC8vIEhhbmRsZSByb290IGRvbWFpbiBhbmQgd3d3IHN1YmRvbWFpbiAtIHJlZGlyZWN0IHRvIGFwcCBkb21haW5cbiAgICBjb25zdCByb290RG9tYWluID0gQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWC5yZXBsYWNlKCcuJywgJycpOyAvLyBcIm1haW4udGxkXCJcbiAgICBjb25zdCB3d3dEb21haW4gPSBgd3d3JHtDVVNUT01FUl9ET01BSU5fU1VGRklYfWA7IC8vIFwid3d3Lm1haW4udGxkXCJcbiAgICBcbiAgICBpZiAoIXRlbmFudFNsdWcgfHwgdGVuYW50U2x1Zy5sZW5ndGggPT09IDAgfHwgaG9zdG5hbWUgPT09IHd3d0RvbWFpbiB8fCBob3N0bmFtZSA9PT0gcm9vdERvbWFpbikge1xuICAgICAgLy8gSWYgaXQncyBleGFjdGx5IFwibWFpbi50bGRcIiBvciBcInd3dy5tYWluLnRsZFwiLCByZWRpcmVjdCB0byBhcHAgZG9tYWluXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJ2h0dHBzOi8vd3d3LnJldm9sLmFwcCcsIHJlcXVlc3QudXJsKSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEZvciBjdXN0b21lciB3ZWJzaXRlIHJlcXVlc3RzLCByZXdyaXRlIHRvIC90ZW5hbnQgcm91dGVcbiAgICAvLyBUaGlzIGFsbG93cyB1cyB0byB1c2UgTmV4dC5qcyByb3V0aW5nIHdoaWxlIG1haW50YWluaW5nIHN1YmRvbWFpbi1iYXNlZCBhY2Nlc3NcbiAgICBjb25zdCBwYXRobmFtZSA9IHJlcXVlc3QubmV4dFVybC5wYXRobmFtZTtcbiAgICBcbiAgICAvLyBSZXdyaXRlIHRvIC90ZW5hbnQgZm9yIGFsbCBjdXN0b21lciBkb21haW4gcmVxdWVzdHNcbiAgICAvLyBUaGUgdGVuYW50IHBhZ2Ugd2lsbCBleHRyYWN0IHRoZSBzbHVnIGZyb20gdGhlIGhvc3RuYW1lXG4gICAgY29uc3QgdXJsID0gcmVxdWVzdC5uZXh0VXJsLmNsb25lKCk7XG4gICAgdXJsLnBhdGhuYW1lID0gJy90ZW5hbnQnO1xuICAgIFxuICAgIC8vIEFkZCB0ZW5hbnQgc2x1ZyB0byBoZWFkZXJzIGZvciB1c2UgaW4gcm91dGUgaGFuZGxlcnNcbiAgICBjb25zdCByZXNwb25zZSA9IE5leHRSZXNwb25zZS5yZXdyaXRlKHVybCk7XG4gICAgcmVzcG9uc2UuaGVhZGVycy5zZXQoJ3gtdGVuYW50LXNsdWcnLCB0ZW5hbnRTbHVnKTtcbiAgICBcbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH1cbiAgXG4gIC8vIEZvciBhcHAgZG9tYWluIChyZXZvbC5hcHApLCBlbnN1cmUgd2UncmUgbm90IHNlcnZpbmcgY3VzdG9tZXIgY29udGVudFxuICAvLyBCbG9jayBhbnkgL3B1YmxpYy9bc2x1Z10gcm91dGVzIG9uIGFwcCBkb21haW4gKHRoZXkgc2hvdWxkIG9ubHkgd29yayBvbiAqLm1haW4udGxkKVxuICBpZiAoQVBQX0RPTUFJTlMuc29tZShkb21haW4gPT4gaG9zdG5hbWUgPT09IGRvbWFpbiB8fCBob3N0bmFtZS5lbmRzV2l0aChgLiR7ZG9tYWlufWApKSkge1xuICAgIGNvbnN0IHBhdGhuYW1lID0gcmVxdWVzdC5uZXh0VXJsLnBhdGhuYW1lO1xuICAgIFxuICAgIC8vIEJsb2NrIHB1YmxpYyByb3V0ZXMgb24gYXBwIGRvbWFpblxuICAgIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvcHVibGljLycpKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLnJlZGlyZWN0KG5ldyBVUkwoJy8nLCByZXF1ZXN0LnVybCkpO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuICBcbiAgLy8gRGVmYXVsdDogYWxsb3cgdGhlIHJlcXVlc3RcbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcbiAgICAvKlxuICAgICAqIE1hdGNoIGFsbCByZXF1ZXN0IHBhdGhzIGV4Y2VwdCBmb3IgdGhlIG9uZXMgc3RhcnRpbmcgd2l0aDpcbiAgICAgKiAtIGFwaSAoQVBJIHJvdXRlcylcbiAgICAgKiAtIF9uZXh0L3N0YXRpYyAoc3RhdGljIGZpbGVzKVxuICAgICAqIC0gX25leHQvaW1hZ2UgKGltYWdlIG9wdGltaXphdGlvbiBmaWxlcylcbiAgICAgKiAtIGZhdmljb24uaWNvIChmYXZpY29uIGZpbGUpXG4gICAgICovXG4gICAgJy8oKD8hYXBpfF9uZXh0L3N0YXRpY3xfbmV4dC9pbWFnZXxmYXZpY29uLmljbykuKiknLFxuICBdLFxufTtcblxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsIkFQUF9ET01BSU5TIiwiQ1VTVE9NRVJfRE9NQUlOX1NVRkZJWCIsIm1pZGRsZXdhcmUiLCJyZXF1ZXN0IiwiaG9zdCIsImhlYWRlcnMiLCJnZXQiLCJob3N0bmFtZSIsInNwbGl0IiwiZW5kc1dpdGgiLCJ0ZW5hbnRTbHVnIiwicmVwbGFjZSIsInRvTG93ZXJDYXNlIiwicm9vdERvbWFpbiIsInd3d0RvbWFpbiIsImxlbmd0aCIsInJlZGlyZWN0IiwiVVJMIiwidXJsIiwicGF0aG5hbWUiLCJuZXh0VXJsIiwiY2xvbmUiLCJyZXNwb25zZSIsInJld3JpdGUiLCJzZXQiLCJzb21lIiwiZG9tYWluIiwic3RhcnRzV2l0aCIsIm5leHQiLCJjb25maWciLCJtYXRjaGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./src/middleware.ts\n");

/***/ })

});